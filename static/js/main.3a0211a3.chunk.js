(this.webpackJsonpchat_client=this.webpackJsonpchat_client||[]).push([[0],{16:function(e,s,t){},17:function(e,s,t){},18:function(e,s,t){"use strict";t.r(s);var a,n,r,c=t(0),l=t(6),o=t.n(l),i=t(1),d=t.n(i),u=(t(16),t(10)),j=t(7),m=t(2),g=t(3),h=t(5),b=t(4),O=t(9),v=t.p+"static/media/doge.5d220b76.png",x=(t(17),t(6));document.getElementById("chat"),document.getElementById("login-modal"),document.getElementById("message"),document.getElementById("title"),document.getElementById("users"),new Set;function p(e){var s=new Date(1e3*e);return console.log(s),s.toLocaleDateString("en-US")+" "+s.toLocaleTimeString("en-US")}function f(e){if(a=document.getElementById("username"),n=document.getElementById("password"),document.getElementById("url"),void 0==sessionStorage.accessToken){r=document.getElementById("url");var s=new FormData;s.append("password",n.value),s.append("username",a.value),sessionStorage.url=r.value,fetch(sessionStorage.url+"/login",{method:"POST",body:s}).then((function(e){201==e.status?(n.value="",a.value="",e.text().then((function(e){var s;sessionStorage.accessToken=JSON.parse(e).token,d.a.render(Object(c.jsx)("div",(s={id:"content",className:"MainPage"},Object(O.a)(s,"className","MainPage"),Object(O.a)(s,"children",Object(c.jsx)(S,{})),s)),document.getElementById("login-modal"))}))):403===e.status?alert("Username or Password is invalid"):alert("Request failed with error code: "+e.status)})).catch((function(e){return alert(e)}))}else alert("TOKEN IS ALREADY DEFINED.")}var S=function(e){Object(h.a)(t,e);var s=Object(b.a)(t);function t(e){var a;return Object(m.a)(this,t),(a=s.call(this,e)).state={source:new EventSource(sessionStorage.url+"/stream/"+sessionStorage.accessToken),users:new Set,messages:new Set},a}return Object(g.a)(t,[{key:"componentDidMount",value:function(){var e=this,s=this.state,t=s.source;s.users,s.messages;t.addEventListener("Disconnect",(function(s){t.close(),e.setState({users:new Set,messages:new Set}),delete sessionStorage.accessToken,d.a.render(Object(c.jsx)(E,{}),document.getElementById("myroot"))})),t.addEventListener("Join",(function(s){var t=JSON.parse(s.data),a=Object(c.jsxs)("li",{children:[Object(c.jsx)("mark",{className:"date",children:p(t.created)}),Object(c.jsx)("mark",{className:"newUserMessage",children:" Someone joined! Say hello to "}),Object(c.jsx)("mark",{className:"newUser",children:t.user}),Object(c.jsx)("mark",{className:"newUserMessage",children:"!"})]},t.created),n=e.state.users,r=e.state.messages;n.add(t.user),r.add(a),e.setState({users:n,messages:r});var l=document.getElementById("MessageFeed");l.scrollTop=l.scrollHeight-l.clientHeight})),t.addEventListener("Message",(function(s){var t=JSON.parse(s.data);console.log(t.message);var a=e.state.messages,n=(p(t.created),t.user,t.message,Object(c.jsxs)("li",{children:[Object(c.jsx)("mark",{className:"date",children:p(t.created)}),Object(c.jsx)("mark",{className:"user",children:" ("+t.user+") "}),Object(c.jsx)("mark",{className:"message",children:t.message})]},t.created));console.log(n),a.add(n),e.setState({messages:a});var r=document.getElementById("MessageFeed");r.scrollTop=r.scrollHeight-r.clientHeight})),t.addEventListener("Part",(function(s){var t=JSON.parse(s.data),a=Object(c.jsxs)("li",{children:[Object(c.jsx)("mark",{className:"date",children:p(t.created)}),Object(c.jsx)("mark",{className:"newUserMessage",children:" Someone left :( Say goodbye to "}),Object(c.jsx)("mark",{className:"userLeft",children:t.user}),Object(c.jsx)("mark",{className:"newUserMessage",children:"."})]},t.created),n=e.state.users,r=e.state.messages;n.delete(t.user),r.add(a),e.setState({users:n,messages:r});var l=document.getElementById("MessageFeed");l.scrollTop=l.scrollHeight-l.clientHeight})),t.addEventListener("ServerStatus",(function(s){var t=JSON.parse(s.data),a=Object(c.jsxs)("li",{children:[Object(c.jsx)("mark",{className:"date",children:p(t.created)}),Object(c.jsx)("mark",{className:"serverUpdateMessage",children:" Server Status: "+t.status})]},t.created),n=e.state.messages;n.add(a),e.setState({messages:n})})),t.addEventListener("Users",(function(s){var t=new Set(JSON.parse(s.data).users);e.setState({users:t});var a=document.getElementById("MessageFeed");a.scrollTop=a.scrollHeight-a.clientHeight})),t.addEventListener("error",(function(s){alert("Error. You probably refreshed the page, didn't you?"),2==s.target.readyState?(e.setState({users:new Set,messages:new Set}),delete sessionStorage.accessToken,d.a.render(Object(c.jsx)(E,{}),document.getElementById("myroot"))):alert("You have been disconnected!  We will attempt to reconnect now.")}))}},{key:"render",value:function(){var e=this.state.users,s=this.state.messages;return Object(c.jsxs)("div",{children:[Object(c.jsx)(k,{users:e}),Object(c.jsxs)("div",{className:"Messages",children:[Object(c.jsx)(N,{messages:s}),Object(c.jsx)(y,{})]})]})}}]),t}(x.Component),y=function(e){Object(h.a)(t,e);var s=Object(b.a)(t);function t(e){var a;return Object(m.a)(this,t),(a=s.call(this,e)).state={message:""},a.handleChange=a.handleChange.bind(Object(j.a)(a)),a.sendMessage=a.sendMessage.bind(Object(j.a)(a)),a}return Object(g.a)(t,[{key:"sendMessage",value:function(){!function(e){if(""!==e){var s=new FormData;s.append("message",e),fetch(sessionStorage.url+"/message",{method:"POST",body:s,headers:{Authorization:"Bearer "+sessionStorage.accessToken}}).then((function(e){201!==e.status&&(403===e.status?alert("Token was invalid."):alert("Received bad response: "+e.status))})).catch((function(e){return alert(e)}))}else alert("Your message is blank.")}(this.state.message),this.setState({message:""})}},{key:"handleChange",value:function(e){this.setState({message:e.target.value})}},{key:"render",value:function(){var e=this.state.message;return Object(c.jsxs)("div",{children:[Object(c.jsx)("input",{className:"MessageText",placeholder:"Type your message here and click >>> to send.",value:e,onChange:this.handleChange}),Object(c.jsx)("button",{className:"MessageButton",onClick:this.sendMessage,children:">>>"})]})}}]),t}(x.Component),N=function(e){Object(h.a)(t,e);var s=Object(b.a)(t);function t(e){var a;return Object(m.a)(this,t),(a=s.call(this,e)).state={messages:e.messages},a}return Object(g.a)(t,[{key:"render",value:function(){var e,s=this.props.messages,t=[],a=Object(u.a)(s);try{for(a.s();!(e=a.n()).done;){var n=e.value;t.push(n)}}catch(r){a.e(r)}finally{a.f()}return Object(c.jsxs)("div",{className:"InnerMessages",children:[Object(c.jsx)("h3",{children:"Messages:"}),Object(c.jsx)("ul",{id:"MessageFeed",className:"messages",children:t})]})}}]),t}(x.Component),k=function(e){Object(h.a)(t,e);var s=Object(b.a)(t);function t(e){var a;return Object(m.a)(this,t),(a=s.call(this,e)).state={users:e.users},a}return Object(g.a)(t,[{key:"render",value:function(){var e,s=this.props.users,t=[],a=Object(u.a)(s);try{for(a.s();!(e=a.n()).done;){var n=e.value;t.push(Object(c.jsx)("li",{children:n},n))}}catch(r){a.e(r)}finally{a.f()}return Object(c.jsxs)("div",{className:"Users",children:[Object(c.jsx)("h3",{children:"Users:"}),Object(c.jsx)("ul",{className:"users",children:t})]})}}]),t}(x.Component),E=function(e){Object(h.a)(t,e);var s=Object(b.a)(t);function t(e){var a;return Object(m.a)(this,t),(a=s.call(this,e)).state={loggedIn:!1},null!=sessionStorage.accessToken&&delete sessionStorage.accessToken,a}return Object(g.a)(t,[{key:"render",value:function(){this.state.loggedIn;return Object(c.jsx)("div",{id:"login-modal",className:"App",children:Object(c.jsxs)("div",{id:"content",className:"App-header",children:[Object(c.jsx)("img",{src:v,className:"App-logo",alt:"logo"}),Object(c.jsx)("h2",{children:"Welcome to DogeChat\u2122"}),Object(c.jsx)("div",{children:Object(c.jsxs)("label",{className:"Label",children:["Chat URL ",Object(c.jsx)("br",{}),Object(c.jsx)("input",{className:"LoginText",id:"url",type:"text"})]})}),Object(c.jsx)("div",{children:Object(c.jsxs)("label",{className:"Label",children:["Username ",Object(c.jsx)("br",{}),Object(c.jsx)("input",{id:"username",className:"LoginText",type:"text"})]})}),Object(c.jsx)("div",{children:Object(c.jsxs)("label",{className:"Label",children:["Password ",Object(c.jsx)("br",{}),Object(c.jsx)("input",{id:"password",className:"LoginText",type:"password"})]})}),Object(c.jsx)("br",{}),Object(c.jsx)("button",{className:"LoginButton",onClick:f,children:"Login"})]})})}}]),t}(x.Component);var w=function(){return Object(c.jsx)("div",{id:"myroot",children:Object(c.jsx)(E,{})})},M=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,19)).then((function(s){var t=s.getCLS,a=s.getFID,n=s.getFCP,r=s.getLCP,c=s.getTTFB;t(e),a(e),n(e),r(e),c(e)}))};d.a.render(Object(c.jsx)(o.a.StrictMode,{children:Object(c.jsx)(w,{})}),document.getElementById("root")),M()}},[[18,1,2]]]);
//# sourceMappingURL=main.3a0211a3.chunk.js.map